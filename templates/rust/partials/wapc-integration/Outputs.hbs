
#[derive(Debug)]
pub struct OutputPorts {
{{#each fields}}
    pub {{snakeCase name.value}}: {{pascalCase name.value}}Sender,
{{/each}}
}

{{#each fields}}
#[derive(Debug, PartialEq, Clone)]
pub struct {{pascalCase name.value}}Sender { id: u32 }

impl PortSender for {{pascalCase name.value}}Sender {
  type PayloadType = {{> expand-type type}};
  fn get_name(&self) -> String {
    "{{name.value}}".to_string()
  }
  fn get_id(&self) -> u32 {
    self.id
  }
}
{{/each}}

fn get_outputs(id:u32) -> OutputPorts {
  OutputPorts {
  {{#each fields}}
    {{snakeCase name.value}}: {{pascalCase name.value}}Sender { id },
  {{/each}}
  }
}

#[derive(Debug)]
pub struct Outputs {
  packets: ProviderOutput
}

impl Outputs {
  {{#each fields}}
    pub fn {{snakeCase name.value}}(&mut self)-> Result<PortOutput> {
      let packets = self.packets.take("{{name.value}}").ok_or_else(||ComponentError::new("No packets for port '{{name.value}}' found"))?;
      Ok(PortOutput::new("{{name.value}}".to_owned(), packets))
    }
  {{/each}}
}

impl From<ProviderOutput> for Outputs {
  fn from(packets: ProviderOutput) -> Self {
    Self{packets}
  }
}